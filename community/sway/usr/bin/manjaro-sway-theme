#!/bin/bash

## theme switcher for manjaro sway
THEME_DIR="/usr/share/sway/themes"

prompt() {
    read -p "->${1:+" ${1}."} Press enter to continue..."
}

THEMES=$(find ${THEME_DIR} -mindepth 1 -maxdepth 1 -type d -printf '%f\n' | sort)

echo "!!! Welcome to the Manjaro Sway Theme Selector !!!"
echo
echo "Please select one of the themes below:"
echo

select THEME in $THEMES; do
    THEME_DIR="${THEME_DIR}/${THEME}"
    echo "> Selected theme ${THEME} (${THEME_DIR})"
    echo
    break;
done

# shellcheck disable=SC2046
[ -f  "$THEME_DIR/packages" ] && echo "> Installing theme requirements using yay" && echo && yay -S --needed $(cat "$THEME_DIR/packages")

# copy the sway theme
[ -f  "$THEME_DIR/theme.conf" ] && echo "> Copying the sway theme" && echo && /usr/bin/cp -v --backup "$THEME_DIR/theme.conf" "$HOME/.config/sway/definitions.d/"

# copy the foot theme
[ -f  "$THEME_DIR/foot.ini" ] && echo "> Copying the foot theme" && echo && /usr/bin/cp -v --backup "$THEME_DIR/foot.ini" "$HOME/.config/foot/" 

prompt "Reloading sway"
swaymsg reload >/dev/null